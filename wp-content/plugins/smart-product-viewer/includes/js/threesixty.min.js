!function(e){"use strict";e.ThreeSixty=function(t,r){var a,n=this,o=[];n.$el=e(t),n.el=t,n.$el.data("ThreeSixty",n),n.init=function(){a=e.extend({},e.ThreeSixty.defaultOptions,r),a.parallel||n.loadImages(),a.disableSpin&&(a.currentFrame=1,a.endFrame=1),n.initProgress()},n.initProgress=function(){n.$el.css({width:a.width+"px"}).css(a.styles),a.responsive&&n.$el.css({width:"100%"}),n.$el.find(a.progress).css({marginTop:a.height/2-15+"px"}),n.$el.find(a.progress).fadeIn("slow"),n.$el.find(a.imgList).hide()},n.loadImages=function(){var t,r,i;t=document.createElement("li"),r=a.images[a.loadedImages]+(e.browser.msie?"?"+(new Date).getTime():""),i=e("<img>").attr("src",r).addClass("previous-image").appendTo(t),o.push(i),n.$el.find(a.imgList).append(t),e(i).load(function(){n.imageLoaded()})},n.imageLoaded=function(){a.loadedImages+=1,e(a.progress+" span").text(Math.floor(a.loadedImages/a.totalFrames*100)+"%"),a.loadedImages>=a.totalFrames?(a.disableSpin&&o[0].removeClass("previous-image").addClass("current-image"),e(a.progress).fadeOut("slow",function(){e(this).hide(),e(a.preview).css("opacity",0),n.showImages(),n.showNavigation()})):n.loadImages()},n.showImages=function(){n.$el.find(a.imgList).fadeIn(),n.ready=!0,a.ready=!0,a.drag&&n.initEvents(),n.refresh(),n.initPlugins(),a.onReady()},n.initPlugins=function(){e.each(a.plugins,function(t,r){if("function"!=typeof e[r])throw new Error(r+" not available.");e[r].call(n,n.$el,a)})},n.showNavigation=function(){if(a.navigation&&!a.navigation_init){var t,r,o,i;if(t=e("<div/>").attr("class","threesixty-nav-bar"),r=e("<a/>").attr({href:"#","class":"threesixty-next"}).html("next"),o=e("<a/>").attr({href:"#","class":"threesixty-previous"}).html("previous"),a.startAutoplay)var s="threesixty-stop";else var s="threesixty-play";i=e("<a/>").attr({href:"#","class":s}).html("play"),t.append(o),t.append(i),t.append(r),n.$el.prepend(t),r.bind("mousedown touchstart",n.next),o.bind("mousedown touchstart",n.previous),i.bind("mousedown touchstart",n.play_stop),a.navigation_init=!0}},n.play_stop=function(t){t.preventDefault(),a.autoplay?(a.autoplay=!1,e(t.currentTarget).removeClass("threesixty-stop").addClass("threesixty-play"),clearInterval(a.play),a.play=null):(a.autoplay=!0,a.play=setInterval(n.moveToNextFrame,a.interval),e(t.currentTarget).removeClass("threesixty-play").addClass("threesixty-stop"))},n.next=function(e){e&&e.preventDefault(),a.endFrame-=5,n.refresh()},n.previous=function(e){e&&e.preventDefault(),a.endFrame+=5,n.refresh()},n.play=function(e){a.autoplay||(a.autoplay=!0,a.play=setInterval(n.moveToNextFrame,a.interval))},n.stop=function(){a.autoplay&&(a.autoplay=!1,clearInterval(a.play),a.play=null)},n.moveToNextFrame=function(){1===a.autoplayDirection?a.endFrame-=1:a.endFrame+=1,n.refresh()},n.gotoAndPlay=function(e){if(a.disableWrap)a.endFrame=e,n.refresh();else{var t=Math.ceil(a.endFrame/a.totalFrames);0===t&&(t=1);var r=t>1?a.endFrame-(t-1)*a.totalFrames:a.endFrame,o=a.totalFrames-r,i=0;i=e-r>0?e-r<r+(a.totalFrames-e)?a.endFrame+(e-r):a.endFrame-(r+(a.totalFrames-e)):o+e>r-e?a.endFrame-(r-e):a.endFrame+(o+e),r!==e&&(a.endFrame=i,n.refresh())}},n.initEvents=function(){n.$el.bind("mousedown touchstart touchmove touchend mousemove click",function(t){e(t.target).hasClass("threesixty-mfp-anchor")||e(t.target).hasClass("mfp-close")||(t.preventDefault(),"mousedown"===t.type&&1===t.which||"touchstart"===t.type?(a.pointerStartPosX=n.getPointerEvent(t).pageX,a.dragging=!0,a.autoplay&&(a.stopped=!0,n.stop())):"touchmove"===t.type?n.trackPointer(t):"touchend"===t.type&&(a.dragging=!1,a.stopped&&(a.stopped=!1,n.play())),"click"!==t.type||n.browser.isIE()||n.$el.removeClass("threesixty-hand-open").addClass("threesixty-hand-closed"))}),e(document).bind("mouseup",function(t){a.dragging=!1,a.stopped&&(a.stopped=!1,n.play()),e(this).removeClass("threesixty-hand-open"),e(this).removeClass("threesixty-hand-closed")}),e(document).bind("mousemove",function(e){a.dragging?(e.preventDefault(),!n.browser.isIE()&&a.showCursor&&n.$el.removeClass("threesixty-hand-open").addClass("threesixty-hand-closed")):!n.browser.isIE()&&a.showCursor&&n.$el.removeClass("threesixty-hand-closed").addClass("threesixty-hand-open"),n.trackPointer(e)})},n.getPointerEvent=function(e){return e.originalEvent.targetTouches?e.originalEvent.targetTouches[0]:e},n.trackPointer=function(e){a.ready&&a.dragging&&(a.pointerEndPosX=n.getPointerEvent(e).pageX,a.monitorStartTime<(new Date).getTime()-a.monitorInt&&(a.pointerDistance=a.pointerEndPosX-a.pointerStartPosX,a.pointerDistance>0?a.endFrame=a.currentFrame+Math.ceil((a.totalFrames-1)*a.speedMultiplier*(a.pointerDistance/n.$el.width())):a.endFrame=a.currentFrame+Math.floor((a.totalFrames-1)*a.speedMultiplier*(a.pointerDistance/n.$el.width())),a.disableWrap&&(a.endFrame=Math.min(a.totalFrames-(a.zeroBased?1:0),a.endFrame),a.endFrame=Math.max(a.zeroBased?0:1,a.endFrame)),n.refresh(),a.monitorStartTime=(new Date).getTime(),a.pointerStartPosX=n.getPointerEvent(e).pageX))},n.refresh=function(){0===a.ticker&&(a.ticker=setInterval(n.render,Math.round(1e3/a.framerate)))},n.render=function(){var e;a.currentFrame!==a.endFrame?(e=a.endFrame<a.currentFrame?Math.floor(.1*(a.endFrame-a.currentFrame)):Math.ceil(.1*(a.endFrame-a.currentFrame)),n.hidePreviousFrame(),a.currentFrame+=e,n.showCurrentFrame(),n.$el.trigger("frameIndexChanged",[n.getNormalizedCurrentFrame(),a.totalFrames])):(window.clearInterval(a.ticker),a.ticker=0)},n.hidePreviousFrame=function(){void 0!==o[n.getNormalizedCurrentFrame()]&&o[n.getNormalizedCurrentFrame()].removeClass("current-image").addClass("previous-image")},n.showCurrentFrame=function(){void 0!==o[n.getNormalizedCurrentFrame()]&&o[n.getNormalizedCurrentFrame()].removeClass("previous-image").addClass("current-image")},n.getNormalizedCurrentFrame=function(){var e,t;return a.disableWrap?(e=Math.min(a.currentFrame,a.totalFrames-(a.zeroBased?1:0)),t=Math.min(a.endFrame,a.totalFrames-(a.zeroBased?1:0)),e=Math.max(e,a.zeroBased?0:1),t=Math.max(t,a.zeroBased?0:1),a.currentFrame=e,a.endFrame=t):(e=Math.ceil(a.currentFrame%a.totalFrames),0>e&&(e+=a.totalFrames-1)),e},n.zeroPad=function(e){function t(e,t){var r=e.toString();if(a.zeroPadding)for(;r.length<t;)r="0"+r;return r}var r=Math.log(a.totalFrames)/Math.LN10,n=1e3,o=Math.round(r*n)/n,i=Math.floor(o)+1;return t(e,i)},n.browser={},n.browser.isIE=function(){var e=-1;if("Microsoft Internet Explorer"===navigator.appName){var t=navigator.userAgent,r=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");null!==r.exec(t)&&(e=parseFloat(RegExp.$1))}return-1!==e},n.init()},e.ThreeSixty.defaultOptions={dragging:!1,ready:!1,pointerStartPosX:0,pointerEndPosX:0,pointerDistance:0,monitorStartTime:0,monitorInt:10,ticker:0,speedMultiplier:7,totalFrames:180,currentFrame:0,endFrame:0,loadedImages:0,framerate:60,domains:null,domain:"",parallel:!1,queueAmount:8,idle:0,filePrefix:"",ext:"png",height:300,width:300,styles:{},navigation:!1,autoplay:!1,autoplayDirection:1,disableSpin:!1,disableWrap:!1,responsive:!1,zeroPadding:!1,zeroBased:!1,plugins:[],showCursor:!1,drag:!0,startAutoplay:!1,interval:40,onReady:function(){}},e.fn.ThreeSixty=function(t){return Object.create(new e.ThreeSixty(this,t))}}(jQuery),"function"!=typeof Object.create&&(Object.create=function(e){"use strict";function t(){}return t.prototype=e,new t}),function(e){"use strict";e.ThreeSixtyFullscreen=function(t,r){var a=this,n=t,o=e("<a href='#'>Fullscreen</a>"),i=!1,s=["webkit","moz","ms","o",""];o.bind("click",function(e){a.onClickHandler.apply(this,e)}),a.setStyles=function(){return o.css({"z-index":12,display:"block",position:"absolute",background:"url(img/fs.png) no-repeat",width:"20px",height:"20px","text-indent":"-99999px",right:"5px",bottom:"5px","background-position":"0px -20px"}),this},a.RunPrefixMethod=function(e,t){for(var r,a,n=0;n<s.length&&!e[r];){if(r=t,""===s[n]&&(r=r.substr(0,1).toLowerCase()+r.substr(1)),r=s[n]+r,a=typeof e[r],"undefined"!==a)return s=[s[n]],"function"===a?e[r]():e[r];n++}},a.init=function(){a.setStyles(),n.prepend(o)},a.onClickHandler=function(e){var t;if("undefined"!=typeof n.attr("id"))t=document.getElementById(n.attr("id"));else{if("undefined"==typeof n.parent().attr("id"))return!1;t=document.getElementById(n.parent().attr("id"))}a.toggleFullscreen(t)},a.toggleButton=function(){i?o.css({"background-position":"0px 0px"}):o.css({"background-position":"0px -20px"})},a.toggleFullscreen=function(e){a.RunPrefixMethod(document,"FullScreen")||a.RunPrefixMethod(document,"IsFullScreen")?a.RunPrefixMethod(document,"CancelFullScreen"):a.RunPrefixMethod(e,"RequestFullScreen"),a.toggleButton()},a.init()}}(jQuery);